@if (loading()) {
  <div class="flex flex-col items-center justify-center min-h-screen">
    <h1>Cargando Personajes</h1>
    <span class="loading loading-dots loading-xl"></span>
  </div>
} @else {

  <div class="mx-5 my-2">
    <h1 class="text-2xl font-bold mb-1">Lost Vikings</h1>

    <div class="flex mb-4 gap-3 items-center">
      <h2 class="text-xl">Ordenar Por:</h2>
      <select class="select" #sortBy (change)="sortCharacters(sortBy.value)">
        <option value="defecto" disabled selected>Defecto</option>
        <option value="nombre">Nombre</option>
        <option value="nivel">Nivel</option>
        <option value="ilevel">ILevel</option>
        <option value="raza">Raza</option>
        <option value="clase">Clase</option>
        <option value="ultima">Última conexión</option>
        <option value="faccion">Facción</option>
      </select>

      <input
        type="text"
        placeholder="Buscar por nombre..."
        class="input input-bordered w-full max-w-xs"
        (input)="searchTerm.set($any($event.target).value)"
      />
    </div>

    <div class="overflow-x-auto rounded-box border border-base-content/5 bg-base-100">
      <table class="table">
        <thead>
        <tr>
          <th>#</th>
          <th>Imagen</th>
          <th>Nombre</th>
          <th>Nivel</th>
          <th>iLevel</th>
          <th>Raza</th>
          <th>Clase</th>
          <th>Última conexión</th>
          <th>Facción</th>
        </tr>
        </thead>
        <tbody>
          @for (champ of paginatedCharacters(); track $index) {
            <tr>
              <th>{{ $index + 1 + ((currentPage() - 1) * itemsPerPage) }}</th>
              <td>
                <div class="flex items-center gap-3">
                  <div class="avatar">
                    <div class="mask mask-squircle h-16 w-16">
                      <img [src]="champ.mediaUrl" alt="Character portrait"/>
                    </div>
                  </div>
                </div>
              </td>
              <td>{{ champ.name }}</td>
              <td>{{ champ.level }}</td>
              <td>{{ champ.iLevel }}</td>
              <td>{{ champ.race }}</td>
              <td [style.color]="champ.class | classColor">{{ champ.class }}</td>
              <td>{{ formatPlayTime(+champ.lastPlayed) | date: 'dd/MM/yyyy HH:mm' }}</td>
              <td [style.color]="champ.faction | factionColor">{{ champ.faction }}</td>
            </tr>
          }
        </tbody>
      </table>

      <div class="mt-3 mb-7 flex justify-center items-center gap-4">
        <button class="btn" [disabled]="currentPage() === 1" (click)="prevPage()">Previa</button>
        <span>Página {{ currentPage() }} de {{ totalPages() }}</span>
        <button class="btn" [disabled]="currentPage() === totalPages()" (click)="nextPage()">Siguiente</button>
      </div>
    </div>
  </div>

}
